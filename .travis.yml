sudo: required
language: python
python:
- '2.7'
addons:
  apt:
    packages:
    - sshpass
services:
- docker
install:
- pip install -r requirements.txt
script:
- python tests.py
before_install:
- docker --version
- docker build -t $DOCKER_USERNAME/simple_flask_app:latest .
- docker images
- openssl aes-256-cbc -K $encrypted_83630750896a_key -iv $encrypted_83630750896a_iv
  -in deploy_key.enc -out ./deploy_key -d
after_success:
- docker login -u "$DOCKER_USERNAME" -p "$DOCKER_PASSWORD";
- docker push $DOCKER_USERNAME/simple_flask_app:latest
- export SSHPASS=$DEPLOY_PASS
deploy:
  provider: script
  skip_cleanup: true
  script: chmod 600 deploy_key && sshpass -e ssh -o StrictHostKeyChecking=no -i ./deploy_key
    uksdocker@147.91.177.194 './deploy.sh'
  on:
    branch: master
env:
  global:
  - secure: fXf3/Tel8VPJ71UsYNCLSUH/8tNTyFW23ZDJXjnKgVA5cmkCkbuqWEEUWFrTB8KwbedpxqcPHdmVOC+pf8aXqelSDeJzKJ8KU+i8IW8irl/r3cGHhOp0wvnOHnMxnXk9+1Aq5LMdyZSryEBfX6zPlCdAOW66+X0a43U6QRRtQDMg/ikWVzXe5Qx5pT6xb0Wr1lH4Ob3ezZDs1OUBEdSRgne6D5FC5i1OHxZEOMzc5jvoJcVN/7F4uxpE8ZU8vZIa5/Rxfu6xmHgf+roOJwKMYxbuO3L9dOvOZ0l4ixhwODk1v25xNGTRsq9arrO9VYW4kUM9ARDu5LfBnFA9+/nocbc4CeYkIUktCRpbwV+39MAV6J1IXCumPdTz97OM8DZbPCVPamWda4ynxAMnXk/nWFf0B9X7c2kEPdW3GeRwFDyU6JQbaAXVbIDnGPgWb+qT7wClv+ZJ7y9r5q1Fm+treRfAitosPEdLfOCCEEcFrzGHGSchAs0J+PG9azzSiG/57VylVxpR/fFlSXWfcMO6kFhig4dB2un5TrL7qUTcDKnZ3iCV7seKjmYMH27+VRmqBgEYeC0rt+NOykzu9Gc2Fsx8KFfo2tZwPo0FISSEKDmZkYF0WLbLSWttiV3DWCm4UfbHScEIJcuFKZ5z3NffbG6CEGt3VJu+1/6qAD4v+Sw=
  - secure: hn9tI74oI5Ik8gh+ktl+KSgdxsd7bdkqwwOlUUz52VkaOWnw3Jf/EaEZwfIToUJkWRKEDjNocm6xwsI9pkb9Q5k/v50xRc/wAAQh+wVTWhZjWuaEWOQDhCyvNVwOc1Xj6qN6HsFM4Glw3Bw/+KNyRBT6mxNIuO76TKpk7sexmMaMwbucdT7M8t+6xplWiYqiLL8c3TOCmiAZQID6BfuPkhaB5xYgAHKqdJVbuZPf96vnk7dVQOA1g3abHYFKq/T55GOdrv9JcXztn8CCIib6h85SfOjS4A3FmVouKQucC66/LJYSGK7qcobKfxkGobCT9snIwqpRiBJPUlVyQqF+JUaV8Ya/E359nhtPoaYx26/AfPtRU4gtJ1mlW7V69JSKufYtfxn2it0p7WvzGjCgp8Evz3MFmwTxGn1k29T3Rb1yYw9sq5gDLVlIQPpTPjktURY5Tlt/nUzLbpGaN5DyL5tvQFJKzD6bbHmcdmeqewlnrBpFogzPpehIyvO0fIWANUPMG19FGWUPD58vd9bmi5WMpb3+DWIB/AM4/DjHMpr99gW2przv8OS5oxfqzAqc3Cpr+vBCd7YH3WH7NC57JbwSiId+AnONa/KupN6JDyqDljwC9cq+M8OqZ6qqb0b3JTFqwC6gE4XgwHyXIe/9kpQt8Mww3A7K49Az7ygZnKw=
  - secure: 2dkGnFh1sKZaf5yKa8k41BeackPyQKEJDEIjTQrCfMDNrmTF81iIKdkm7B3oODct4hgabVwH/WI8xe1sSnlvZKX80vJG4Ua3k+yVFKqUbMNVGHimLUhmRl3joBYcumbYrbrFMJJz+BYLJh6UPIpFrY9xdxyvLEf7/SES5sgV+NXmhoubgPr5aMHPhhusUHE6/xV+rAnrViu+Os8371qKulzylHHxI8gvVwe//vo6fZmfzxHu2TCYwxND2YYzSSZ8V7Hb8ct88RMFms30/VlMJLu5cq0UxYREHf2t/s8Z+oN6ZYOITEbj8VvpBhEyZzmJaviWLmChtcoHY0D2YTJJVAmjUaYSZjPh1H58U9DZtz5SyywNs9RgnOcFqeG5+RLgCdBaWR5YdiVfUuQOEZlFZBqBTFXsSwTPtHPatFCcJIc9QBRZtqrX1wN4kJ7pAJT56I2yl9Ccdvzgd399eU2jlcvlY+Viq8c2VZo99VTxpiYKGMXecqjNAUdgA/2ihU/BCeNgJ6bNnatHOAT+ROr98vsI2GauVYkpNMoZDYoa/YHcckPQ4+vFPylTZ9sKhbDHYslRwyVi3mNjr7Yj8+epVBxYFSdZhFmw/mHtcSecugg+kp6mFkup2yZZYs6untft6qqNkt1qNvSN9gQ+y8hM2c2Os7cFvMNHR/x8w18HK3g=
